--------  Scratch Pad, not for production use but to rifle off ideas while reviewing questions  --------

-- Are there duplicate/delta leads based on phone (primary identifier)/address information (secondary identifier)?
-- select primary identifier, count all records grouped by primary identifier having count > 1 and repeat for secondary identifier. Reference the 

-- Of the delta leads, what data has changed since previous loads?
-- leverage Type 2 SCD snapshot models to return leads with multiple records in the table and compare their column values

-- How many net new leads are generated by each file ingested?
-- count the number of unique lead identifiers (address || phone) with a dbt_valid_from date >= most recent file ingestion date, where the unique identifier does not have subsequent records in the table conatining a dbt_valid_from date < most recent file ingestion date

-- Which source gives the best performing leads?
-- leverage the source column all_sources_flattened to measure how many leads are closed-won from each source over a period of time 